# This is a cleaned up SwayFX configuration file.
# It includes settings for removing title bars, adding rounded corners, and setting gaps between windows.
### Variables
#
# Logo key. Use Mod1 for Alt.
set $mod Mod4
# Home row direction keys, like vim
set $left h
set $down j
set $up k
set $right l
# Your preferred terminal emulator
set $term ghostty
# Your preferred application launcher
set $rofi_cmd rofi -terminal '$term'
set $menu $rofi_cmd -show combi -combi-modes drun#run -modes combi

# Stop sleep while in fullscreen video
for_window [class="^.*"] inhibit_idle fullscreen

### Outputs and Appearance
#
# Set default wallpaper
exec swww-daemon
swaybg_command - # Disable for separate bg manager
# output * bg $HOME/Pictures/wallpapers/night-study.jpeg fill
for_window [app_id="waypaper"] floating enable
for_window [app_id="thunar"] floating enable

# SwayFX Visuals
# Remove title bars and window borders
for_window [class=".*"] opacity 0.9
default_border pixel 2
default_floating_border none
# Enable rounded corners with a radius of 10 pixels
corner_radius 10
# Set inner and outer gaps to add space between windows
gaps inner 5
gaps outer 0
gaps top 0
# Enable blur effects
blur enable
blur_radius 10
blur_passes 2

### Input configuration
#
# Add your specific input device configurations here.
# Example configuration:
# input "2:14:SynPS/2_Synaptics_TouchPad" {
#    dwt enabled
#    tap enabled
#    natural_scroll enabled
#    middle_emulation enabled
# }

# primary_selection disabled # Not available on SwayFX

input "type:touchpad" {
    tap enabled
    natural_scroll enabled
    middle_emulation enabled
    scroll_factor 0.5
    drag_lock disabled
  }

### Key bindings
#
# Basics<D-S>
bindsym $mod+Return exec $term
bindsym $mod+Shift+q kill
bindsym $mod+d exec $menu
floating_modifier $mod normal
bindsym $mod+Shift+c reload
bindsym $mod+Shift+e exec swaynag -t warning -m 'You pressed the exit shortcut. Do you really want to exit sway? This will end your Wayland session.' -B 'Yes, exit sway' 'swaymsg exit'

# Focus and Moving Windows
bindsym $mod+$left focus left
bindsym $mod+$down focus down
bindsym $mod+$up focus up
bindsym $mod+$right focus right
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right
bindsym $mod+Shift+$left move left
bindsym $mod+Shift+$down move down
bindsym $mod+Shift+$up move up
bindsym $mod+Shift+$right move right
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

# Workspaces
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+6 workspace number 6
bindsym $mod+7 workspace number 7
bindsym $mod+8 workspace number 8
bindsym $mod+9 workspace number 9
bindsym $mod+0 workspace number 10
bindsym $mod+Shift+1 move container to workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4
bindsym $mod+Shift+5 move container to workspace number 5
bindsym $mod+Shift+6 move container to workspace number 6
bindsym $mod+Shift+7 move container to workspace number 7
bindsym $mod+Shift+8 move container to workspace number 8
bindsym $mod+Shift+9 move container to workspace number 9
bindsym $mod+Shift+0 move container to workspace number 10

# Layouts
bindsym $mod+b splith
bindsym $mod+v splitv
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split
bindsym $mod+f fullscreen
bindsym $mod+Shift+space floating toggle
bindsym $mod+space focus mode_toggle
bindsym $mod+a focus parent

# Scratchpad
bindsym $mod+Shift+minus move scratchpad
bindsym $mod+minus scratchpad show

# Resize Mode
bindsym $mod+r mode "resize"
mode "resize" {
    bindsym $left resize shrink width 10px
    bindsym $down resize grow height 10px
    bindsym $up resize shrink height 10px
    bindsym $right resize grow width 10px
    bindsym Left resize shrink width 10px
    bindsym Down resize grow height 10px
    bindsym Up resize shrink height 10px
    bindsym Right resize grow width 10px
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

# Scripts 
bindsym $mod+Tab exec ~/scripts/next_wallpaper.sh

# Toggle Waybar visibility with Super+o
bindsym $mod+Shift+o exec killall -SIGUSR1 waybar

# Include other config files
include '$(/usr/libexec/sway/layered-include "/usr/share/sway/config.d/*.conf" "/etc/sway/config.d/*.conf" "${XDG_CONFIG_HOME:-$HOME/.config}/sway/config.d/*.conf")'

# Grimshot Overrides
# 1. Screenshot to Clipboard with Preview (Ctrl+Shift+Print)
# Creates temp file, captures area, copies to clipboard, sends notification, cleans up.
bindsym Ctrl+Shift+Print exec sh -c 'TEMP_FILE="$(mktemp --suffix=.png)"; grim -g "$(slurp)" "$TEMP_FILE" && { cat "$TEMP_FILE" | wl-copy; notify-send "Screenshot Copied" "Copied to clipboard." -i "$TEMP_FILE"; sleep 0.1; rm "$TEMP_FILE"; } || notify-send "Cancelled" "No area selected." -u low'

# 2. Toggle Screen Recording (Mod+Shift+r) - Now records to .webm
# Logic: checks if wf-recorder is running, otherwise prompts for area and starts recording to WebM.
bindsym $mod+Shift+r exec sh -c 'FILENAME_TEMP_PATH="/tmp/wf-recorder-file.txt"; \
if pgrep "wf-recorder" > /dev/null; then \
    pkill -SIGINT wf-recorder; \
    STOPPED_FILE=$(cat "$FILENAME_TEMP_PATH" 2>/dev/null); \
    notify-send "Recording Stopped" "Saved to: $STOPPED_FILE" -u normal -h string:x-dunst-stack-tag:wf-recording -t 5000; \
    rm -f "$FILENAME_TEMP_PATH"; \
else \
    RECORDING_DIR="$HOME/Videos/Recorders"; \
    mkdir -p "$RECORDING_DIR"; \
    FILENAME="$RECORDING_DIR/recording-$(date +%Y%m%d-%H%M%S).webm"; \
    SELECTION=$(slurp); \
    if [ -n "$SELECTION" ]; then \
        echo "$FILENAME" > "$FILENAME_TEMP_PATH"; \
        \
        (wf-recorder -g "$SELECTION" -f "$FILENAME") & \
        \
        notify-send "RECORDING LIVE" "Area is being recorded." -i media-record -u critical -h string:x-dunst-stack-tag:wf-recording -t 0; \
    else \
        notify-send "Recording Cancelled" "No area was selected." -u low -a "wf-recorder"; \
    fi; \
fi'

